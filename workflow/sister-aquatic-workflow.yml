cwlVersion: v1.2
class: Workflow
inputs:
  workflow_context: File
  pge_prep_filepath: string
  run_pge_filepath: string
  post_pge_filepath: string
  input_context: File[]?
  pges_to_run: string?

outputs:
  context:
    type: File[]
    outputSource: l2_benthic_cover-workflow/context

requirements:
  SubworkflowFeatureRequirement: {}
  MultipleInputFeatureRequirement: {}
  InlineJavascriptRequirement: {}

steps:
  l2b_benthic_inversion-workflow:
    run: pge-workflow.yml
    in:
      pge_prep_filepath: pge_prep_filepath
      workflow_context: workflow_context
      step_key:
        default: "l2b_benthic_inversion"
      input_context: input_context
      run_pge_filepath: run_pge_filepath
      post_pge_filepath: post_pge_filepath
      pges_to_run: pges_to_run
    out: [context]
    when: $(inputs.pges_to_run.includes("benthic"))

  l2b_aquatic_pigments_inversion-workflow:
    run: pge-workflow.yml
    in:
      pge_prep_filepath: pge_prep_filepath
      workflow_context: workflow_context
      step_key:
        default: "l2b_aquatic_pigments"
      input_context: input_context
      run_pge_filepath: run_pge_filepath
      post_pge_filepath: post_pge_filepath
      pges_to_run: pges_to_run
    out: [ context ]
    when: $(inputs.pges_to_run.includes("pigments"))
